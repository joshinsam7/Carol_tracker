{"ast":null,"code":"var _jsxFileName = \"/Users/joshinsam/Projects/webapps/carol-tracker/frontend/src/App.js\",\n  _s = $RefreshSig$();\n/* eslint-disable max-len */\n/* eslint-disable require-jsdoc */\nimport React, { useEffect, useState } from \"react\";\nimport \"./App.css\";\nimport BusMap from \"./components/BusMap.js\";\nimport { Header } from \"./components/header\";\nimport Information from \"./components/Information\";\nimport Summary from \"./components/summary\";\nimport { Helmet } from \"react-helmet-async\";\nimport SnowParticles from \"./components/SnowFlakes\";\nimport useBusSocket from \"./hooks/useBusSocket\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  // ------------------- State -------------------\n  const [stops, setStops] = useState([]);\n  const [showInfo, setShowInfo] = useState(false);\n  const [busStatus, setBusStatus] = useState(\"idle\");\n  const [currentLocation, setCurrentLocation] = useState({\n    lat: 29.619707,\n    lng: -95.3193855\n  });\n  const [currentStop, setCurrentStop] = useState(null);\n  const [nextStop, setNextStop] = useState(null);\n  const [lastUpdate, setLastUpdate] = useState(null);\n  const [routeETA, setRouteETA] = useState(null);\n  const API_URL = process.env.REACT_APP_API || \"http://localhost:3001\";\n  const {\n    data: busData\n  } = useBusSocket(process.env.REACT_APP_SOCKET || \"ws://localhost:3001\");\n\n  // ------------------- Fetch stops -------------------\n  useEffect(() => {\n    if (!API_URL) return console.warn(\"API URL is not defined in environment variables.\");\n    fetch(`${API_URL}/api/getStops`).then(res => res.json()).then(data => setStops(data.stops || [])).catch(err => console.error(\"Failed to fetch stops:\", err));\n  }, [API_URL]);\n\n  // ------------------- Handle WebSocket bus data -------------------\n  useEffect(() => {\n    if (!(busData !== null && busData !== void 0 && busData.data) || stops.length === 0) return;\n\n    // Build stops map here, only when busData or stops change\n    const stopsMap = new Map();\n    stops.forEach(s => (s === null || s === void 0 ? void 0 : s.id) != null && stopsMap.set(s.id, s));\n    const {\n      lat,\n      lng,\n      status,\n      currentStop: csId,\n      nextStop: nsId,\n      lastUpdate: lu\n    } = busData.data;\n    setBusStatus(status || \"idle\");\n    setCurrentStop(csId != null ? stopsMap.get(csId) || null : null);\n    setNextStop(nsId != null ? stopsMap.get(nsId) || null : null);\n    setCurrentLocation({\n      lat: lat !== null && lat !== void 0 ? lat : 29.619707,\n      lng: lng !== null && lng !== void 0 ? lng : -95.3193855\n    });\n    setLastUpdate(lu ? new Date(lu).toLocaleTimeString() : null);\n  }, [busData, stops]);\n\n  // ------------------- Compute sorted stops -------------------\n  const sortedStops = nextStop ? [nextStop, ...stops.filter(s => s.id !== nextStop.id)] : stops;\n\n  // ------------------- Toggle Info -------------------\n  const toggleInfo = () => setShowInfo(prev => !prev);\n\n  // ------------------- Render -------------------\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(SnowParticles, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"App-header\",\n      children: [/*#__PURE__*/_jsxDEV(Helmet, {\n        children: /*#__PURE__*/_jsxDEV(\"meta\", {\n          name: \"viewport\",\n          content: \"width=device-width, initial-scale=1.0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Header, {\n        toggleInfo: toggleInfo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"main-layout\",\n      children: [/*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"map-column\",\n        style: {\n          position: \"relative\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(BusMap, {\n          data: stops,\n          currentLocation: currentLocation,\n          destinationStop: nextStop || {},\n          busStatus: busStatus,\n          setRouteETA: setRouteETA\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Summary, {\n          data: stops,\n          nextStop: nextStop,\n          currentStop: currentStop,\n          lastUpdate: lastUpdate,\n          currentLocation: currentLocation,\n          routeETA: routeETA\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n        className: `side right ${showInfo ? \"open\" : \"\"}`,\n        children: /*#__PURE__*/_jsxDEV(Information, {\n          data: sortedStops,\n          nextStop: nextStop\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"BSVgb708LUuFDWDP2X4FLUth/Cw=\", false, function () {\n  return [useBusSocket];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","BusMap","Header","Information","Summary","Helmet","SnowParticles","useBusSocket","jsxDEV","_jsxDEV","App","_s","stops","setStops","showInfo","setShowInfo","busStatus","setBusStatus","currentLocation","setCurrentLocation","lat","lng","currentStop","setCurrentStop","nextStop","setNextStop","lastUpdate","setLastUpdate","routeETA","setRouteETA","API_URL","process","env","REACT_APP_API","data","busData","REACT_APP_SOCKET","console","warn","fetch","then","res","json","catch","err","error","length","stopsMap","Map","forEach","s","id","set","status","csId","nsId","lu","get","Date","toLocaleTimeString","sortedStops","filter","toggleInfo","prev","className","children","fileName","_jsxFileName","lineNumber","columnNumber","name","content","style","position","destinationStop","_c","$RefreshReg$"],"sources":["/Users/joshinsam/Projects/webapps/carol-tracker/frontend/src/App.js"],"sourcesContent":["/* eslint-disable max-len */\n/* eslint-disable require-jsdoc */\nimport React, {useEffect, useState} from \"react\";\nimport \"./App.css\";\nimport BusMap from \"./components/BusMap.js\";\nimport {Header} from \"./components/header\";\nimport Information from \"./components/Information\";\nimport Summary from \"./components/summary\";\nimport {Helmet} from \"react-helmet-async\";\nimport SnowParticles from \"./components/SnowFlakes\";\nimport useBusSocket from \"./hooks/useBusSocket\";\n\nfunction App() {\n  // ------------------- State -------------------\n  const [stops, setStops] = useState([]);\n  const [showInfo, setShowInfo] = useState(false);\n  const [busStatus, setBusStatus] = useState(\"idle\");\n  const [currentLocation, setCurrentLocation] = useState({lat: 29.619707, lng: -95.3193855});\n  const [currentStop, setCurrentStop] = useState(null);\n  const [nextStop, setNextStop] = useState(null);\n  const [lastUpdate, setLastUpdate] = useState(null);\n  const [routeETA, setRouteETA] = useState(null);\n\n  const API_URL = process.env.REACT_APP_API || \"http://localhost:3001\";\n  const {data: busData} = useBusSocket(process.env.REACT_APP_SOCKET || \"ws://localhost:3001\");\n\n  // ------------------- Fetch stops -------------------\n  useEffect(() => {\n    if (!API_URL) return console.warn(\"API URL is not defined in environment variables.\");\n\n    fetch(`${API_URL}/api/getStops`)\n        .then((res) => res.json())\n        .then((data) => setStops(data.stops || []))\n        .catch((err) => console.error(\"Failed to fetch stops:\", err));\n  }, [API_URL]);\n\n  // ------------------- Handle WebSocket bus data -------------------\n  useEffect(() => {\n    if (!busData?.data || stops.length === 0) return;\n\n    // Build stops map here, only when busData or stops change\n    const stopsMap = new Map();\n    stops.forEach((s) => s?.id != null && stopsMap.set(s.id, s));\n\n    const {lat, lng, status, currentStop: csId, nextStop: nsId, lastUpdate: lu} = busData.data;\n\n    setBusStatus(status || \"idle\");\n    setCurrentStop(csId != null ? stopsMap.get(csId) || null : null);\n    setNextStop(nsId != null ? stopsMap.get(nsId) || null : null);\n    setCurrentLocation({lat: lat ?? 29.619707, lng: lng ?? -95.3193855});\n    setLastUpdate(lu ? new Date(lu).toLocaleTimeString() : null);\n  }, [busData, stops]);\n\n  // ------------------- Compute sorted stops -------------------\n  const sortedStops = nextStop ?\n    [nextStop, ...stops.filter((s) => s.id !== nextStop.id)] :\n    stops;\n\n  // ------------------- Toggle Info -------------------\n  const toggleInfo = () => setShowInfo((prev) => !prev);\n\n  // ------------------- Render -------------------\n  return (\n    <div className=\"App\">\n      <SnowParticles />\n      <header className=\"App-header\">\n        <Helmet>\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n        </Helmet>\n        <Header toggleInfo={toggleInfo} />\n      </header>\n\n      <main className=\"main-layout\">\n        <section className=\"map-column\" style={{position: \"relative\"}}>\n          <BusMap\n            data={stops}\n            currentLocation={currentLocation}\n            destinationStop={nextStop || {}}\n            busStatus={busStatus}\n            setRouteETA={setRouteETA}\n          />\n\n          <Summary\n            data={stops}\n            nextStop={nextStop}\n            currentStop={currentStop}\n            lastUpdate={lastUpdate}\n            currentLocation={currentLocation}\n            routeETA={routeETA}\n          />\n        </section>\n\n        <aside className={`side right ${showInfo ? \"open\" : \"\"}`}>\n          <Information data={sortedStops} nextStop={nextStop} />\n        </aside>\n      </main>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}